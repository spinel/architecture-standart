# Архитектурное решение для MVP системы открытия депозитов

## Название задачи
Разработка архитектуры MVP системы открытия депозитов для банка "Стандарт"

## Автор
Команда цифровой трансформации банка "Стандарт"

## Дата
2025-06-10

## Функциональные требования

### Use Cases

| № | Действующие лица или системы | Use Case | Описание |
|:-:|:-|:-|:-|
| 1 | Клиент, Сайт | Подача заявки на депозит через сайт | 1. Клиент просматривает список доступных депозитов с актуальными ставками<br>2. Клиент заполняет форму заявки (ФИО, номер телефона)<br>3. Система сохраняет заявку и отправляет уведомление в кол-центр |
| 2 | Клиент, Интернет-банк | Подача заявки на депозит через интернет-банк | 1. Клиент просматривает список доступных депозитов с персонализированными ставками<br>2. Клиент выбирает депозит, указывает счет и сумму<br>3. Система запрашивает подтверждение через SMS<br>4. Клиент подтверждает операцию<br>5. Система создает заявку и отправляет уведомление в бэк-офис |
| 3 | Менеджер кол-центра, Система кол-центра | Обработка заявки с сайта | 1. Менеджер получает уведомление о новой заявке<br>2. Менеджер просматривает детали заявки<br>3. Менеджер связывается с клиентом для уточнения деталей<br>4. Менеджер может предложить особые условия<br>5. Менеджер передает заявку в бэк-офис |
| 4 | Менеджер бэк-офиса, АБС | Обработка заявки на депозит | 1. Менеджер получает заявку из интернет-банка или кол-центра<br>2. Менеджер проверяет условия депозита<br>3. Менеджер подтверждает условия в АБС<br>4. Система отправляет SMS-уведомление клиенту |
| 5 | АБС, SMS-шлюз | Отправка уведомлений | 1. АБС формирует уведомление о статусе заявки<br>2. Система отправляет уведомление через SMS-шлюз |

## Нефункциональные требования

| № | Требование |
|:-:|:-|
| 1 | Система должна быть доступна 24/7 с uptime 99.9% |
| 2 | Время отклика системы не должно превышать 1 секунду |
| 3 | Необходимо обеспечить шифрование трафика при передаче чувствительных данных |
| 4 | Система должна поддерживать горизонтальное масштабирование |
| 5 | Необходимо обеспечить равномерное распределение нагрузки между серверами |
| 6 | Система должна быть совместима с существующими технологиями банка (MS SQL, Oracle) |
| 7 | Необходимо избежать прямой работы интернет-банка с API АБС |
| 8 | Система должна соответствовать принятой в компании системе дизайна |

## Решение

### Контекстная диаграмма
[контекстная диаграмма](context-diagram.puml)

Основные компоненты системы:
1. Сайт банка
2. Интернет-банк
3. Система кол-центра
4. АБС
5. SMS-шлюз
6. База данных ставок

### Диаграмма контейнеров
[диаграмма контейнеров](container-diagram.puml)

Детализация компонентов:

#### Интернет-банк
- Веб-интерфейс (ASP.NET MVC 4.5)
- API Gateway
- Сервис депозитов
- Сервис аутентификации
- Сервис уведомлений
- База данных (MS SQL)

#### АБС
- Десктопный клиент (Delphi)
- Сервис обработки депозитов
- Сервис уведомлений
- База данных (Oracle)

### Логика принятия решений

1. **Выбор технологий**
   - Использование существующих технологий банка для минимизации рисков
   - Предпочтение MS SQL и Oracle для совместимости с текущей инфраструктурой
   - Использование ASP.NET MVC для интернет-банка в соответствии с текущей платформой

2. **Архитектурные решения**
   - Внедрение API Gateway для изоляции интернет-банка от АБС
   - Использование очередей сообщений для асинхронной обработки заявок
   - Реализация сервиса уведомлений для централизованной отправки SMS

3. **Интеграционные решения**
   - Использование REST API для взаимодействия между системами
   - Внедрение промежуточного слоя для работы с АБС
   - Реализация механизма синхронизации ставок по депозитам

## Альтернативы

### Альтернатива 1: Прямая интеграция с АБС
**Преимущества:**
- Простота реализации
- Меньше промежуточных компонентов

**Недостатки:**
- Высокие риски для основной системы
- Сложность масштабирования
- Зависимость от производительности АБС

### Альтернатива 2: Микросервисная архитектура
**Преимущества:**
- Высокая масштабируемость
- Изоляция компонентов
- Гибкость в развитии

**Недостатки:**
- Сложность реализации
- Высокие требования к инфраструктуре
- Необходимость в дополнительных компетенциях

## Недостатки, ограничения, риски

### Недостатки
1. Сложность синхронизации данных между системами
2. Необходимость поддержки нескольких баз данных
3. Зависимость от производительности АБС
4. Ограничения в масштабировании из-за вертикального масштабирования АБС

### Ограничения
1. Необходимость идентификации новых клиентов в отделении
2. Совместимость с текущей версией интернет-банка
3. Ограничения в использовании новых технологий
4. Зависимость от подрядчиков в обновлении ядра систем

### Риски
1. Перегрузка АБС при большом количестве заявок
2. Сложности в синхронизации ставок по депозитам
3. Зависимость от доступности SMS-шлюза
4. Риски безопасности при передаче чувствительных данных 